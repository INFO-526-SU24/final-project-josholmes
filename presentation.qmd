---
title: "Apprenticeship by Geographical Region and University Presence."
subtitle: "INFO 526 - Summer 2024 - Final Project"
author: "Joshua Holmes"
title-slide-attributes:
  data-background-image: images/watercolour_sys02_img34_teacup-ocean.jpg
  data-background-size: stretch
  data-background-opacity: "0.7"
  data-slide-number: none
format:
  revealjs:
    theme:  ['data/customtheming.scss']
  
editor: visual
execute:
  echo: false
---

```{r}
#| label: load-packages
#| include: false

# Load packages here
pacman::p_load(tidymodels,
               tidyverse,
               here)

```

```{r}
#| label: setup
#| include: false

# Plot theme
ggplot2::theme_set(ggplot2::theme_minimal(base_size = 11))

# For better figure resolution
knitr::opts_chunk$set(
  fig.retina = 3, 
  dpi = 300, 
  fig.width = 6, 
  fig.asp = 0.618 
  )
```

```{r}
#| label: load-data
#| include: false
# Load data here


edu_data <- read_csv(here("data", "edudata.csv"))
```

## Introducing our Data Set

Educational attainment of young people in English towns

-   The data set contains 1104 rows and 31 columns

-   Data set contains information related to towns, population, regional information, coastal classification, job density, income, university presence, and education attainment statistics

## Why I Chose the Data Set

-   It was the first data set that upon reviewing I immediately though of a question

-   I saw that the data contained

    -   If universities where present

    -   How many 19 year olds were in apprenticeships

-   I suspected that a greater percentage would attend apprenticeships in towns where universities weren't present

## Question

-   Had two variables; university presence, 19 year olds in apprenticeships

-   Needed a third variable so I added in region

## Data

-   colmun name: rgn11nm

```{r}
unique(edu_data$rgn11nm)
```

-   colmun name: university_flag

```{r}
unique(edu_data$university_flag)
```

-   column name: activity_at_age_19

```{r}
glimpse(edu_data$activity_at_age_19_appprenticeships)
```

## Organizing Data

-   Organizing and removing "NA" values from our data set

    -   select(activity_at_age_19_appprenticeships, rgn11nm, university_flag)

    -   na.omit()

```{r}

edu_data <- edu_data |> select(activity_at_age_19_appprenticeships, rgn11nm, university_flag) |> na.omit() 

glimpse(edu_data)
```

## Creating GGplot - geom_point

```{r}

ggplot(edu_data, aes(x = university_flag, y = activity_at_age_19_appprenticeships, color = rgn11nm)) +
  geom_point(size = 1) +
  labs(title = "Percentage of 19-year-olds in Apprenticeships by University Presence and Region",
       x = "University Presence",
       y = "Percentage of Apprenticeships",
       color = "Region") +
  theme_minimal()

```

## Creating ggplot - Boxplot

```{r}
ggplot(edu_data, aes(x = university_flag, y = activity_at_age_19_appprenticeships, fill = rgn11nm)) +
  geom_boxplot() +
  labs(title = "Distribution of Apprenticeships by University Presence and Region",
       x = "University Presence",
       y = "Percentage of Apprenticeships",
       fill = "Region") +
  theme_minimal()
```

## Creating ggplot - Boxplot - Facet_Grid

```{r}

ggplot(edu_data, aes(y = activity_at_age_19_appprenticeships, fill = rgn11nm)) +
  geom_boxplot() +
  facet_grid(vars(university_flag),vars(rgn11nm),labeller = labeller(rgn11nm = label_wrap_gen(10)))+
  labs(title = "Distribution of Apprenticeships by University Presence and Region",
       x = "",
       y = "Percentage of Apprenticeships",
       fill = "Region") +
  theme_minimal()+
  theme(
    legend.position = "null",
    axis.text.x = element_blank()
  
  )


```

## Conclusion

-   North East and North West regions have higher median of 19-year olds in apprenticeships

-   The distribution spread of 19-year olds in apprenticeship is greater in towns with no university and more consolidated in towns with universities

-   The North West contains the towns with the highest precentage of 19-years olds in apprenticeships but they are outliners.

-   The North East region has the highest median number of 19-year olds in apprenticeships
