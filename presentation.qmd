---
title: "How the presence of universities and  impact the number of young adults in apprenticeship."
subtitle: "INFO 526 - Summer 2024 - Final Project"
author: "Joshua Holmes"
title-slide-attributes:
  data-background-image: images/watercolour_sys02_img34_teacup-ocean.jpg
  data-background-size: stretch
  data-background-opacity: "0.7"
  data-slide-number: none
format:
  revealjs:
    theme:  ['data/customtheming.scss']
  
editor: visual
execute:
  echo: false
---

```{r}
#| label: load-packages
#| include: false

# Load packages here
pacman::p_load(tidymodels,
               tidyverse)

```

```{r}
#| label: setup
#| include: false

# Plot theme
ggplot2::theme_set(ggplot2::theme_minimal(base_size = 11))

# For better figure resolution
knitr::opts_chunk$set(
  fig.retina = 3, 
  dpi = 300, 
  fig.width = 6, 
  fig.asp = 0.618 
  )
```

```{r}
#| label: load-data
#| include: false
# Load data here
data(mtcars)
mtcars$speed <- mtcars$hp / mtcars$wt

data("penguins")

edu_data <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2024/2024-01-23/english_education.csv')
```

# Using Quarto for presentations

## Quarto

-   The presentation is created using the Quarto CLI

-   `##` sets the start of a new slide

## Layouts

You can use plain text

::: columns
::: {.column width="40%"}
-   or bullet points[^1]
:::

::: {.column width="60%"}
or in two columns
:::
:::

[^1]: And add footnotes

-   like

-   this

## Code

```{r, echo=FALSE}
model <- lm(mpg ~ speed, data = mtcars) 

model |> tidy()

model |> glance()

```

## Plots

```{r}
penguins |>
  mutate(species = ifelse(species == "Adelie", "Adelie", "Other")) |>
  ggplot(aes(x = flipper_length_mm, y = body_mass_g, color = species)) +
  geom_point()
```

## Plot and text

::: columns
::: {.column width="50%"}
-   Some text

-   goes here
:::

::: {.column width="50%"}
```{r, warning=FALSE, fig.width=5.5}
penguins |>
  ggplot(aes(x = bill_length_mm, y = species, color = species)) +
  geom_boxplot(linewidth = 0.75,
               outlier.size = 2.5) +
  theme_minimal(base_size = 15) +
  theme(legend.key.size = unit(0.8, "cm"))
```
:::
:::

# A new section...

## Tables

If you want to generate a table, make sure it is in the HTML format (instead of Markdown or other formats), e.g.,

```{r}
penguins |> 
  head() |>
  kableExtra::kable() |>
  kableExtra::kable_styling()
```

## Images

![Image credit: Danielle Navarro, Percolate.](images/watercolour_sys02_img34_teacup-ocean.png){fig-align="center" width="500"}

## Math Expressions {.smaller}

You can write LaTeX math expressions inside a pair of dollar signs, e.g.Â \$\\alpha+\\beta\$ renders $\alpha + \beta$. You can use the display style with double dollar signs:

```         
$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$
```

$$
\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i
$$

Limitations:

1.  The source code of a LaTeX math expression must be in one line, unless it is inside a pair of double dollar signs, in which case the starting `$$` must appear in the very beginning of a line, followed immediately by a non-space character, and the ending `$$` must be at the end of a line, led by a non-space character;

2.  There should not be spaces after the opening `$` or before the closing `$`.

# Wrap up

## Feeling adventurous?

-   You are welcomed to use the default styling of the slides. In fact, that's what I expect majority of you will do. You will differentiate yourself with the content of your presentation.

-   But some of you might want to play around with slide styling. Some solutions for this can be found at https://quarto.org/docs/presentations/revealjs.

## Introducing our Data Set

Educational attainment of young people in English towns

-   The data set contains 1104 rows and 31 columns

-   Data set contains information related to towns, population, regional information, coastal classification, job density, income, university presence, and education attainment statistics

## Why I Chose the Data Set

-   It was the first data set that upon reviewing I could immediately envisioned multiple visuals that could be created around the data set

-   I saw that the data contained

    -   If universities where present

    -   How many 19 year olds were in apprenticeships

-   I suspected that a greater percentage would attend apprenticeships in towns where universities weren't present

-   I wanted to see if I was correct

## Question

-   Had two variables; university presence, 19 year olds in apprenticeships

-   Needed a third variable so I added in region

## Region / University Data

-   colmun name: rgn11nm

```{r}
unique(edu_data$rgn11nm)
```

-   colmun name: university_flag

```{r}
unique(edu_data$university_flag)
```

## 19 Year Olds In Apprenticeships

-   column name: activity_at_age_19

-   multiple columns - Need to make sure the data is normalized based on town populations and can be compared between towns

-   Data is the percentage of the 2012/2013 cohort that is in apprenticeship so it is already normalized to factor for town population

```{r}
edu_data |> 
  select(starts_with("activity")) |>
  names()
```

## Organizing Data

-   Organizing and removing "NA" values from our data set

    -   select(activity_at_age_19_appprenticeships, rgn11nm, university_flag)

    -   na.omit()

```{r}

edu_data <- edu_data |> select(activity_at_age_19_appprenticeships, rgn11nm, university_flag) |> na.omit() 

glimpse(edu_data)
```

## Creating GGplot - geom_point

```{r}

ggplot(edu_data, aes(x = university_flag, y = activity_at_age_19_appprenticeships, color = rgn11nm)) +
  geom_point(size = 1) +
  labs(title = "Percentage of 19-year-olds in Apprenticeships by University Presence and Region",
       x = "University Presence",
       y = "Percentage of Apprenticeships",
       color = "Region") +
  theme_minimal()

```

## Interpenetration of Geom_point

-   Looks like there is a higher percentage of 19 years in apprenticeships in town with no university

-   Looks like the North East and North West have higher numbers of aprrenticeships

-   Geom_point doesn't tell use much about the distribution so we'll create a box pot to see the distribution

## Creating ggplot - Boxplot

```{r}
ggplot(edu_data, aes(x = university_flag, y = activity_at_age_19_appprenticeships, fill = rgn11nm)) +
  geom_boxplot() +
  labs(title = "Distribution of Apprenticeships by University Presence and Region",
       x = "University Presence",
       y = "Percentage of Apprenticeships",
       fill = "Region") +
  theme_minimal()
```

## Interpreting the Box Plot

-   Looks like the North East and North West have higher median of 19-year olds in apprenticeships in towns without universities

-   The distributions of 19-year olds in apprenticeship is more spread out in towns with no university and more consolidated in towns with universities

-   The North West contains the town with the highest number fo 19-years old in apprenticeships but they are outliers. The median for the North West is behind the North East

-   The North East does not contain the towns with the highest percentage of 19-year olds in apprenticeships but the region has the highest median of 19 year-olds in apprenticeships for both towns with universities present and towns without universities

-    A lot of data clustered together wanted to create a graph that shows the same data but not so congested together

## Creating ggplot - Boxplot - Facet_Grid

```{r}

ggplot(edu_data, aes(y = activity_at_age_19_appprenticeships, fill = rgn11nm)) +
  geom_boxplot() +
  facet_grid(vars(university_flag),vars(rgn11nm),labeller = labeller(rgn11nm = label_wrap_gen(10)))+
  labs(title = "Distribution of Apprenticeships by University Presence and Region",
       x = "",
       y = "Percentage of Apprenticeships",
       fill = "Region") +
  theme_minimal()+
  theme(
    legend.position = "null",
    axis.text.x = element_blank()
  
  )


```
